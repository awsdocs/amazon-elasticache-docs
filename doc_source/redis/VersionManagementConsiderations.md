# Major version behavior and compatibility differences<a name="VersionManagementConsiderations"></a>

**Important**  
The following page is structured to signify all incompability differences between versions and inform you of any considerations you should make when upgrading to newer versions\. This list is inclusive of any version incompability issues you may encounter when upgrading\.  
You can upgrade directly from your current Redis version to the latest Redis version available, without the need for sequential upgrades\. For example, you can upgrade directly from Redis version 2\.0 to version 6\.0

Redis versions are identified with a semantic version which comprise a MAJOR, MINOR, and PATCH component\. For example, in Redis 4\.0\.10, the major version is 4, the minor version 0, and the patch version is 10\. These values are generally incremented based off the following conventions:
+ MAJOR versions are for API incompatible changes
+ MINOR versions are for new functionality added in a backwards\-compatible way
+ PATCH versions are for backwards\-compatible bug fixes and non\-functional changes

We recommend always staying on the latest patch version within a given MAJOR\.MINOR version in order to have the latest performance and stability improvements\. Beginning with Redis 6\.0, ElastiCache for Redis will offer a single version for each Redis OSS minor release, rather than offering multiple patch versions\. ElastiCache for Redis will automatically manage the patch version of your running cache clusters, ensuring improved performance and enhanced security\.

We also recommend periodically upgrading to the latest major version, since most major improvements are not back ported to older versions\. When doing an upgrade that spans major or minor versions, please consider the following list which includes behavior and backwards incompatible changes released with Redis over time\. 

## Redis 7\.0 behavior and backwards incompatible changes<a name="VersionManagementConsiderations-redis70"></a>

For a full list of changes, see [Redis 7\.0 release notes](https://raw.githubusercontent.com/redis/redis/7.0/00-RELEASENOTES)\. 
+ `SCRIPT LOAD` and `SCRIPT FLUSH` are no longer propagated to replicas\. If you need to have some durability for scripts, we recommend you consider using [Redis functions](https://redis.io/docs/manual/programmability/functions-intro/)\.
+ Pubsub channels are now blocked by default for new ACL users\.
+ `STRALGO` command was replaced with the `LCS` command\.
+ The format for `ACL GETUSER` has changed so that all fields show the standard access string pattern\. If you had automation using `ACL GETUSER`, you should verify that it will handle either format\.
+ The ACL categories for `SELECT`, `WAIT`, `ROLE`, `LASTSAVE`, `READONLY`, `READWRITE`, and `ASKING` have changed\.
+ The `INFO` command now shows command stats per sub\-command instead of in the top level container commands\.
+ The return values of `LPOP`, `RPOP`, `ZPOPMIN` and `ZPOPMAX` commands have changed under certain edge cases\. If you use these commands, you should check the release notes and evaluate if you are impacted\.
+ The `SORT` and `SORT_RO` commands now require access to the entire keyspace in order to use the `GET` and `BY` arguments\. 

## Redis 6\.2 behavior and backwards incompatible changes<a name="VersionManagementConsiderations-redis62"></a>

For a full list of changes, see [Redis 6\.2 release notes](https://raw.githubusercontent.com/redis/redis/6.2/00-RELEASENOTES)\. 
+ The ACL flags of the `TIME`, `ECHO`, `ROLE`, and `LASTSAVE` commands were changed\. This may cause commands that were previously allowed to be rejected and vice versa\. 
**Note**  
None of these commands modify or give access to data\.
+ When upgrading from Redis 6\.0, the ordering of key/value pairs returned from a map response to a lua script are changed\. If your scripts use `redis.setresp()` or return a map \(new in Redis 6\.0\), consider the implications that the script may break on upgrades\.

## Redis 6\.0 behavior and backwards incompatible changes<a name="VersionManagementConsiderations-redis60"></a>

For a full list of changes, see [Redis 6\.0 release notes](https://raw.githubusercontent.com/redis/redis/6.0/00-RELEASENOTES)\. 
+ The maximum number of allowed databases has been decreased from 1\.2 million to 10 thousand\. The default value is 16, and we discourage using values much larger than this as we’ve found performance and memory concerns\.
+ Set `AutoMinorVersionUpgrade` parameter to yes, and ElastiCache for Redis will manage the minor version upgrade through self\-service updates\. This will be handled through standard customer\-notification channels via a self\-service update campaign\. For more information, see [Self\-service updates in ElastiCache](AmazonElastiCache/latest/red-ug/Self-Service-Updates.html)\.

## Redis 5\.0 behavior and backwards incompatible changes<a name="VersionManagementConsiderations-redis50"></a>

For a full list of changes, see [Redis 5\.0 release notes](https://raw.githubusercontent.com/redis/redis/5.0/00-RELEASENOTES)\. 
+ Scripts are by replicated by effects instead of re\-executing the script on the replica\. This generally improves performance but may increase the amount of data replicated between primaries and replicas\. There is an option to revert back to the previous behavior that is only available in ElastiCache for Redis 5\.0\.
+ If you are upgrading from Redis 4\.0, some commands in LUA scripts will return arguments in a different order than they did in earlier versions\. In Redis 4\.0, Redis would order some responses lexographically in order to make the responses deterministic, this ordering is not applied when scripts are replicated by effects\.
+ Inn Redis 5\.0\.3 and above, ElastiCache for Redis will offload some IO work to background cores on instance types with more than 4 VCPUs\. This may change the performance characteristics Redis and change the values of some metrics\. For more information, see [ Which Metrics Should I Monitor?  Lists best practices for which CloudWatch metrics to use to monitor your ElastiCache performance\.   The following CloudWatch metrics offer good insight into ElastiCache performance\. In most cases, we recommend that you set CloudWatch alarms for these metrics so that you can take corrective action before performance issues occur\. Metrics to Monitor  CPUUtilization  This is a host\-level metric reported as a percentage\. For more information, see [Host\-Level Metrics](CacheMetrics.HostLevel.md)\.  For smaller node types with 2vCPUs or less, use the `CPUUtilization ` metric to monitor your workload\. Generally speaking, we suggest you set your threshold at 90% of your available CPU\. Because Redis is single\-threaded, the actual threshold value should be calculated as a fraction of the node's total capacity\. For example, suppose you are using a node type that has two cores\. In this case, the threshold for CPUUtilization would be 90/2, or 45%\.  You will need to determine your own threshold, based on the number of cores in the cache node that you are using\. If you exceed this threshold, and your main workload is from read requests, scale your cache cluster out by adding read replicas\. If the main workload is from write requests, depending on your cluster configuration, we recommend that you:   **Redis \(cluster mode disabled\) clusters:** scale up by using a larger cache instance type\.  **Redis \(cluster mode enabled\) clusters:** add more shards to distribute the write workload across more primary nodes\.   Instead of using the Host\-Level metric `CPUUtilization`, Redis users might be able to use the Redis metric `EngineCPUUtilization`, which reports the percentage of usage on the Redis engine core\. To see if this metric is available on your nodes and for more information, see [Metrics for Redis](https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/CacheMetrics.Redis.html)\. For larger node types with 4vCPUs or more, you may want to use the `EngineCPUUtilization` metric, which reports the percentage of usage on the Redis engine core\. To see if this metric is available on your nodes and for more information, see [Metrics for Redis](https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/CacheMetrics.Redis.html)\.   EngineCPUUtilization  For larger node types with 4vCPUs or more, you may want to use the `EngineCPUUtilization` metric, which reports the percentage of usage on the Redis engine core\. To see if this metric is available on your nodes and for more information, see [Metrics for Redis](https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/CacheMetrics.Redis.html)\. For more information, see the **CPUs** section at [Monitoring best practices with Amazon ElastiCache for Redis using Amazon CloudWatch](https://aws.amazon.com/blogs/database/monitoring-best-practices-with-amazon-elasticache-for-redis-using-amazon-cloudwatch/)\.   SwapUsage  This is a host\-level metric reported in bytes\. For more information, see [Host\-Level Metrics](CacheMetrics.HostLevel.md)\. The `FreeableMemory` CloudWatch metric being close to 0 \(i\.e\., below 100MB\) or `SwapUsage` metric greater than the `FreeableMemory` metric indicates a node is under memory pressure\. If this happens, see the following topics:   [Ensuring that you have enough memory to create a Redis snapshot](BestPractices.BGSAVE.md)  [Managing Reserved Memory](redis-memory-management.md)    Evictions  This is a cache engine metric\. We recommend that you determine your own alarm threshold for this metric based on your application needs\.   CurrConnections  This is a cache engine metric\. We recommend that you determine your own alarm threshold for this metric based on your application needs\. An increasing number of *CurrConnections* might indicate a problem with your application; you will need to investigate the application behavior to address this issue\.  For more information, see the **Connections** section at [Monitoring best practices with Amazon ElastiCache for Redis using Amazon CloudWatch](https://aws.amazon.com/blogs/database/monitoring-best-practices-with-amazon-elasticache-for-redis-using-amazon-cloudwatch/)\.   Memory  Memory is a core aspect of Redis\. Understanding the memory utilization of your cluster is necessary to avoid data loss and accommodate future growth of your dataset\. Statistics about the memory utilization of a node are available in the memory section of the Redis [INFO](https://redis.io/commands/info) command\. For more information, see the **Memory** section at [Monitoring best practices with Amazon ElastiCache for Redis using Amazon CloudWatch](https://aws.amazon.com/blogs/database/monitoring-best-practices-with-amazon-elasticache-for-redis-using-amazon-cloudwatch/)\.   Network  One of the determining factors for the network bandwidth capacity of your cluster is the node type you have selected\. For more information about the network capacity of your node, see [Amazon ElastiCache pricing](https://aws.amazon.com/elasticache/pricing/)\. For more information, see the **Network** section at [Monitoring best practices with Amazon ElastiCache for Redis using Amazon CloudWatch](https://aws.amazon.com/blogs/database/monitoring-best-practices-with-amazon-elasticache-for-redis-using-amazon-cloudwatch/)\.   Latency  You can measure a command’s latency with a set of CloudWatch metrics that provide aggregated latencies per data structure\. These latency metrics are calculated using the `commandstats` statistic from the Redis [INFO](https://redis.io/commands/info) command\. For more information, see the **Latency** section at [Monitoring best practices with Amazon ElastiCache for Redis using Amazon CloudWatch](https://aws.amazon.com/blogs/database/monitoring-best-practices-with-amazon-elasticache-for-redis-using-amazon-cloudwatch/)\.   Replication  The volume of data being replicated is visible via the `ReplicationBytes` metric\. Although this metric is representative of the write load on the replication group, it doesnt provide insights into replication health\. For this purpose, you can use the `ReplicationLag` metric\.  For more information, see the **Replication** section at [Monitoring best practices with Amazon ElastiCache for Redis using Amazon CloudWatch](https://aws.amazon.com/blogs/database/monitoring-best-practices-with-amazon-elasticache-for-redis-using-amazon-cloudwatch/)\.  ](CacheMetrics.WhichShouldIMonitor.md) to understand if you need to change which metrics you watch\.

## Redis 4\.0 behavior and backwards incompatible changes<a name="VersionManagementConsiderations-redis40"></a>

For a full list of changes, see [Redis 4\.0 release notes](https://raw.githubusercontent.com/redis/redis/4.0/00-RELEASENOTES)\. 
+ Slow log now logs an additional two arguments, the client name and address\. This change should be backwards compatible unless you are explicitly relying on each slow log entry containing 3 values\.
+ The `CLUSTER NODES` command now returns a slight different format, which is not backwards compatible\. We recommend that clients don’t use this command for learning about the nodes present in a cluster, and instead they should use `CLUSTER SLOTS`\.

## Scheduled EOL<a name="VersionManagementConsiderations-redis3x-scheduled"></a>

### Redis 3\.2 behavior and backwards incompatible changes<a name="VersionManagementConsiderations-redis32"></a>

For a full list of changes, see [Redis 3\.2 release notes](https://raw.githubusercontent.com/redis/redis/3.2/00-RELEASENOTES)\. 
+ There are no compatibility changes to call out for this version\.

For more information, see [Redis versions end of life schedule](deprecated-engine-versions.md)\.

## Past EOL<a name="VersionManagementConsiderations-redis2x-past"></a>

### Redis 2\.8 behavior and backwards incompatible changes<a name="VersionManagementConsiderations-redis28"></a>

For a full list of changes, see [Redis 2\.8 release notes](https://raw.githubusercontent.com/redis/redis/2.8/00-RELEASENOTES)\. 
+ Starting in Redis 2\.8\.22, Redis AOF is no longer supported in ElastiCache for Redis\. We recommend using MemoryDB when data needs to be persisted durably\.
+ Starting in Redis 2\.8\.22, ElastiCache for Redis no longer supports attaching replicas to primaries hosted within ElastiCache\. While upgrading, external replicas will be disconnected and they will be unable to reconnect\. We recommend using client\-side caching, made available in Redis 6\.0 as an alternative to external replicas\.
+ The `TTL` and `PTTL` commands now return \-2 if the key does not exist and \-1 if it exists but has no associated expire\. Redis 2\.6 and previous versions used to return \-1 for both the conditions\.
+ `SORT` with `ALPHA` now sorts according to local collation locale if no `STORE` option is used\.

For more information, see [Redis versions end of life schedule](deprecated-engine-versions.md)\.